
<html>
	<head>

		  <%
            require("../const.jag");
            var name = session.get("username");
            if(name===null){
                response.sendRedirect("login.jag");
            }
            require("template/head.jag");
          %>

<title>DataTables test</title>
<style type="text/css" title="currentStyle">
   @import "../resources/datatables/css/page.css";
   @import "../resources/datatables/css/table.css";
</style>

<script type="text/javascript" language="javascript" src="../resources/datatables/js/jquery.dataTables.js"></script>
<script type="text/javascript" charset="utf-8">
   /* Formating function for row details */
   function fnFormatDetails ( oTable, nTr )
   {


    $.ajax({
				  url: "../controller/get_version_details.jag",
				  context: document.body,
				  data: {"WSO2_QAP_PRODUCT_VERSION_ID": WSO2_QAP_PRODUCT_VERSION_ID}
				}).done(function(data) {
				    var info = JSON.parse(data);
					document.getElementById("productName").innerHTML = "<input type='hidden' name='WSO2_QAP_PRODUCT_ID' value='"+info.WSO2_QAP_PRODUCT_ID+"' >"+ info.WSO2_QAP_PRODUCT_NAME+"</input>";
					document.getElementById("prodcutVersion").innerHTML = "<input type='hidden' name='WSO2_QAP_PRODUCT_VERSION_ID' value='"+ WSO2_QAP_PRODUCT_VERSION_ID +"' >"+ info.WSO2_QAP_PRODUCT_VERSION+"</input>";
				});
            }

       return sOut;
   }

   $(document).ready(function() {
       /*
        * Insert a 'details' column to the table
        */
       var nCloneTh = document.createElement( 'th' );
       var nCloneTd = document.createElement( 'td' );
       nCloneTd.innerHTML = '<img src="../resources/datatables/images/details_open.png">';
       nCloneTd.className = "center";

       $('#test thead tr').each( function () {
           this.insertBefore( nCloneTh, this.childNodes[0] );
       } );

       $('#test tbody tr').each( function () {
           this.insertBefore(  nCloneTd.cloneNode( true ), this.childNodes[0] );
       } );

       /*
        * Initialse DataTables, with no sorting on the 'details' column
        */
       var oTable = $('#test').dataTable( {
           "aoColumnDefs": [
               { "bSortable": false, "aTargets": [ 0 ] }
           ],
           "aaSorting": [[1, 'asc']]
       });


       /* Add event listener for opening and closing details
        * Note that the indicator for showing which row is open is not controlled by DataTables,
        * rather it is done here
        */
       $('#test tbody td img').live('click', function () {
           var nTr = $(this).parents('tr')[0];
           if ( oTable.fnIsOpen(nTr) )
           {
               /* This row is already open - close it */
               this.src = "../resources/datatables/images/details_open.png";
               oTable.fnClose( nTr );
           }
           else
           {
               /* Open this row */
               this.src = "../resources/datatables/images/details_close.png";
               oTable.fnOpen( nTr, fnFormatDetails(oTable, nTr), 'details' );
           }
       } );
   } );
</script>
</head>
<body id="dt_test">
<div id="container">

<table cellpadding="0" cellspacing="0" border="0" class="display" id="test">
<thead>
<tr>
   <th>Rendering engine</th>
   <th>Browser</th>
   <th>Platform(s)</th>
   <th>Engine version</th>
   <th>CSS grade</th>
</tr>
</thead>
<tbody>
<tr class="gradeX">
   <td>Trident</td>
   <td>Internet
        Explorer 4.0</td>
   <td>Win 95+</td>
   <td class="center">4</td>
   <td class="center">X</td>
</tr>
<tr class="gradeC">
   <td>Trident</td>
   <td>Internet
        Explorer 5.0</td>
   <td>Win 95+</td>
   <td class="center">5</td>
   <td class="center">C</td>
</tr>
<tr class="gradeA">
   <td>Trident</td>
   <td>Internet
        Explorer 5.5</td>
   <td>Win 95+</td>
   <td class="center">5.5</td>
   <td class="center">A</td>
</tr>


</tbody>
</table>

</html>